<div class="container py-5">
  <!-- Header -->
  <div class="row mb-5">
    <div class="col-lg-10 mx-auto">
      <!-- Breadcrumb -->
      <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a (click)="goToHome()" class="cursor-pointer">Home</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">Labs</li>
        </ol>
      </nav>

      <!-- Título y descripción -->
      <div class="text-center mb-5">
        <h1 class="display-4 fw-bold mb-3">
          <i class="bi bi-rocket-takeoff me-3"></i>Labs
        </h1>
        <p class="lead text-muted">
          Experimentos y proyectos en desarrollo. Cada idea es validada con tráfico real 
          siguiendo la filosofía <strong>Build in Public</strong>.
        </p>
      </div>

      <!-- Filtros -->
      <div class="d-flex justify-content-center gap-2 mb-5 flex-wrap">
        <button 
          class="btn btn-sm"
          [class.btn-primary]="selectedType === 'all'"
          [class.btn-outline-primary]="selectedType !== 'all'"
          (click)="filterByType('all')">
          Todos ({{ modules.length }})
        </button>
        <button 
          class="btn btn-sm"
          [class.btn-info]="selectedType === 'digital'"
          [class.btn-outline-info]="selectedType !== 'digital'"
          (click)="filterByType('digital')">
          <i class="bi bi-download me-1"></i>
          Digitales
        </button>
        <button 
          class="btn btn-sm"
          [class.btn-success]="selectedType === 'service'"
          [class.btn-outline-success]="selectedType !== 'service'"
          (click)="filterByType('service')">
          <i class="bi bi-briefcase me-1"></i>
          Servicios
        </button>
        <button 
          class="btn btn-sm"
          [class.btn-warning]="selectedType === 'physical'"
          [class.btn-outline-warning]="selectedType !== 'physical'"
          (click)="filterByType('physical')">
          <i class="bi bi-box me-1"></i>
          Físicos
        </button>
      </div>
    </div>
  </div>

  <!-- Grid de módulos -->
  <div class="row g-4" *ngIf="!isLoading && filteredModules.length > 0">
    <div class="col-md-6 col-lg-4" *ngFor="let module of filteredModules">
      <div 
        class="card h-100 shadow-sm cursor-pointer hover-shadow transition"
        (click)="goToModule(module.key)">
        
        <!-- Header con color del módulo -->
        <div 
          class="card-header text-center py-4"
          [style.background-color]="module.color">
          <span class="display-1">{{ module.icon }}</span>
        </div>

        <div class="card-body d-flex flex-column">
          <!-- Badge del tipo -->
          <div class="mb-3">
            <span class="badge" [ngClass]="getTypeBadgeClass(module.type)">
              {{ getTypeLabel(module.type) }}
            </span>
          </div>

          <!-- Título -->
          <h5 class="card-title fw-bold mb-3">{{ module.name }}</h5>

          <!-- Descripción -->
          <p class="card-text text-muted mb-4 flex-grow-1">
            {{ module.description }}
          </p>

          <!-- Footer: Precio -->
          <div class="d-flex justify-content-between align-items-center">
            <span class="h4 mb-0 fw-bold text-primary">
              {{ module.price_base | currency: 'EUR' }}
            </span>
            <button class="btn btn-sm btn-outline-primary">
              Ver más <i class="bi bi-arrow-right ms-1"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty state -->
  <div class="row" *ngIf="!isLoading && filteredModules.length === 0">
    <div class="col-lg-6 mx-auto text-center py-5">
      <i class="bi bi-inbox display-1 text-muted"></i>
      <h3 class="mt-4">No hay módulos disponibles</h3>
      <p class="text-muted">
        No se encontraron experimentos activos en esta categoría.
      </p>
      <button class="btn btn-primary mt-3" (click)="filterByType('all')">
        Ver todos los módulos
      </button>
    </div>
  </div>

  <!-- Loading state -->
  <div class="row" *ngIf="isLoading">
    <div class="col-12 text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="text-muted mt-3">Cargando experimentos...</p>
    </div>
  </div>
</div>

<!-- Custom styles -->
<style>
  .cursor-pointer {
    cursor: pointer;
  }

  .hover-shadow {
    transition: box-shadow 0.3s ease;
  }

  .hover-shadow:hover {
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
    transform: translateY(-2px);
  }

  .transition {
    transition: all 0.3s ease;
  }
</style>
